<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="header.css">
<link rel="stylesheet" href="add.css">
<meta charset="UTF-8">
<title>CampusConnect</title>
</head>
<body>

<div>
  <img src="clogo.png" style="width: 130px; height: auto; position: fixed; top: 10px; left: 0;" >
</div>
<h2 id="title">
  <span class="dark-green">Campus</span> 
  <span class="light-green">Connect</span>
</h2>
<div id="menu">
  <div><a href="home.html?menu=Event">Event</a></div>
  <div><a href="home.html?menu=Exam">Exam</a></div>
  <div><a href="home.html?menu=Faculty">Faculty</a></div>
  <div><a href="home.html?menu=Fees">Fees</a></div>
</div>

<div id="page-content">
  <div id="name">Event</div>
  
  <!-- Note enctype attribute needed for file uploads -->
  <form id="Eventform" method="post" action="/CampusConnect/event" enctype="multipart/form-data">
   <input type="hidden" name="action" value="update">
  <input type="hidden" name="event_id">
    <div>
      <p id="event_name">Event Name</p>
      <input type="text" name="event_name" required>
    </div>
    <div>
      <p id="event_date">Event Date</p>
      <input type="date" name="event_date" required>
    </div>
   <div>
  <p id="dept">Department</p>
  <select name="dept">
    <option value=""></option>
    <option value="1">BCA</option>
    <option value="2">MSc IT</option>
    <option value="3">BCom General</option>
    <option value="4">BA Corporate Economics</option>
    <option value="5">BSc Visual Communication</option>
    <option value="6">BSc Information Technology</option>
    <option value="7">BSc Psychology</option>
    <option value="8">BCom Accounting and Finance</option>
    <option value="9">BCom Computer Applications</option>
    <option value="10">BCom Honours</option>
    <option value="11">BBA</option>
    <option value="12">MA Communication</option>
    <option value="13">MA Human Resource Management</option>
    <option value="14">MA English</option>
    <option value="15">MA International Studies</option>
    <option value="16">MSc Mathematics</option>
    <option value="17">MSc Physics</option>
    <option value="18">MSc Chemistry</option>
    <option value="19">MSc Biotechnology</option>
    <option value="21">MSc Data Science</option>
    <option value="22">MCom General</option>
    <option value="23">BA History</option>
    <option value="24">BA English</option>
    <option value="25">BSc Mathematics</option>
    <option value="26">BSc Physics</option>
    <option value="27">BSc Chemistry</option>
    <option value="28">BSc Plant Biology</option>
    <option value="29">BSc Home Science</option>
    <option value="30">BSc Computer Science</option>
    <option value="31">MSc Psychology</option>

  </select>
</div>
    <div>
      <p>Upload Rulebook</p>
      <input type="file" id="rulebook" name="rulebook">
    </div>
    <div>
      <input type="submit" value="Submit">
    </div>
  </form>
 
</div>
<script>
const params = new URLSearchParams(window.location.search);

const eventName = params.get("event_name");
const eventDate = params.get("event_date");
const deptId    = params.get("dept_id");

if (eventName && eventDate && deptId) {
  fetch(
    "../home_event?" +
    "event_name=" + encodeURIComponent(eventName) +
    "&event_date=" + encodeURIComponent(eventDate) +
    "&dept_id=" + encodeURIComponent(deptId)
  )
    .then(res => {
      if (!res.ok) throw new Error("HTTP " + res.status);
      return res.json();
    })
    .then(d => {
      document.querySelector("[name=event_id]").value = d.event_id; // internal only
      document.querySelector("[name=event_name]").value = d.event_name;
      document.querySelector("[name=event_date]").value = d.event_date;
      document.querySelector("[name=dept]").value = d.dept_id;
    })
}

</script>
</body>
</html>
