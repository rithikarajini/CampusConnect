import java.io.*;


import java.sql.*;
import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.annotation.WebServlet;

@WebServlet("/Registrationservlet")
public class Registrationservlet extends HttpServlet {
    private static final String query = "INSERT INTO REGICC(ID,USERNAME,EMAIL,PASSWORD,CONFIRM_PASSWORD) VALUES(?,?,?,?,?)"; 
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        PrintWriter pw = response.getWriter();
        response.setContentType("text/html");
        int id = Integer.parseInt(request.getParameter("id"));
        String username = request.getParameter("username");
        String email = request.getParameter("email");
        String password = request.getParameter("password");
        String confirm_password = request.getParameter("confirm_password");
        try {
            Class.forName("com.mysql.cj.jdbc.Driver");
        }
        catch(ClassNotFoundException cnf) {
        	cnf.printStackTrace();
        
        }
            try(Connection conn = DriverManager.getConnection("jdbc:mysql:///campusconnect", "root", "25swathi14");
            	PreparedStatement psInsert = conn.prepareStatement(query);){
                psInsert.setInt(1, id);
                psInsert.setString(2, username);
                psInsert.setString(3,email);
                psInsert.setString(4, password);
                psInsert.setString(5, confirm_password);

                int count = psInsert.executeUpdate();
                
                if(count == 1) {
                    pw.println("<h2>Record Is Inserted Successfully</h2>");
                } else {
                    pw.println("<h2>Record Is Not Inserted Successfully</h2>");
                }
                

            }
            catch(SQLException se) {
            	se.printStackTrace();
            	pw.println("<h2>"+se.getMessage()+"</h2>");
            }
            catch(Exception e) {
            	e.printStackTrace();
            	pw.println("<h2>"+e.getMessage()+"</h2>");
            }
    }
            @Override
            protected void doPost(HttpServletRequest request, HttpServletResponse response)
                    throws ServletException, IOException {
            	}
            }

            
           
